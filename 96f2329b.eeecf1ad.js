(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{181:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return u}));var n=a(1),r=a(9),i=(a(0),a(199)),o={lip:3,title:"Libra Upgrade Management",authors:"Zekun Li (@zekun000)",status:"draft",type:"informational",created:"06/09/2020"},s={id:"lip-3",title:"Libra Upgrade Management",description:"# Introduction",source:"@site/all-docs__GENERATED/lip-3.md",permalink:"/lip-3",editUrl:"https://github.com/libra/lip/edit/master/all-docs__GENERATED/lip-3.md"},c=[{value:"Software upgrade",id:"software-upgrade",children:[]},{value:"On-chain state upgrade",id:"on-chain-state-upgrade",children:[{value:"Normal multi-sig transactions",id:"normal-multi-sig-transactions",children:[]},{value:"Multi-sig WriteSet transactions",id:"multi-sig-writeset-transactions",children:[]},{value:"Genesis transactions",id:"genesis-transactions",children:[]}]},{value:"Network protocol upgrade",id:"network-protocol-upgrade",children:[]},{value:"On-chain config update",id:"on-chain-config-update",children:[]},{value:"VM upgrade",id:"vm-upgrade",children:[]},{value:"Consensus protocol upgrade",id:"consensus-protocol-upgrade",children:[]},{value:"Signature scheme change",id:"signature-scheme-change",children:[]},{value:"Smart contract vulnerability fix/Libra Framework upgrade",id:"smart-contract-vulnerability-fixlibra-framework-upgrade",children:[]},{value:"Large fraud",id:"large-fraud",children:[]},{value:"Quorum Loss",id:"quorum-loss",children:[]}],l={rightToc:c};function u(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"introduction"},"Introduction"),Object(i.b)("p",null,"Libra Upgrade Management (LUM) is a set of protocols for the Libra Networks (LN) company to reconfigure the blockchain. With respect to time-sensitive decisions and incident response, LUM provides the Libra Networks--a subsidiary of the Libra Association licensed in Switzerland to operate a payment system--with technical means to respond to critical incidents, as (i) necessitated by its license terms and the law and (ii) as determined by the Libra Network risk appetite/tolerance policy."),Object(i.b)("p",null,"It should be noted that the Association appoints LN officers. Officers are accountable for their actions, and usual measures may be taken upon deviation from their expected conduct.  Hence, the ultimate responsibility and power is by distributed governance of the Association."),Object(i.b)("p",null,"Due to being a reserve backed currency, the true blockchain is the one that is maintained by the Libra Association and reflects the assets in the Libra Reserve. In other words, in contrast to Bitcoin and other \u201cproof of work\u201d and \u201cproof of stake\u201d networks where the miners and users beliefs determine the current fork of the blockchain, with Libra the blockchain used by the Libra Reserve determines the true blockchain. Furthermore, Libra Networks operates as a regulated payment company under a Swiss license and must be able to enforce its policy and oversight, as well as to respond to critical operational incidents."),Object(i.b)("p",null,"The goal of LUM is to provide the Association with means to exercise its authority to reconfigure the blockchain and to effectively remediate any plausible operational incident while maintaining the trust gained through decentralized governance and distributed systems.\nWe first present all building blocks and the reasoning, followed by concrete examples."),Object(i.b)("h1",{id:"building-blocks"},"Building blocks"),Object(i.b)("p",null,"There\u2019s two types of upgrades in the system - (i) updates to the Libra protocol software and (ii) changes to on-chain state. We discuss them correspondingly."),Object(i.b)("h2",{id:"software-upgrade"},"Software upgrade"),Object(i.b)("p",null,"Specification changes go through the LIP process and non-specification changes (e.g. bug fixes and performance improvements) do not need to initiate the LIP process. All software changes are submitted through standard Github reviews and proceed through the code review process before being merged to master."),Object(i.b)("p",null,"Periodically, LN needs to release a new version of software and coordinate the release plan and timeline with all the validator operators. Validator operators are responsible for deploying the software release as per instructions."),Object(i.b)("p",null,"Some specification changes may require all validators to transition at the same height, which is accompanied with an on-chain state value update (described in the next section)."),Object(i.b)("h2",{id:"on-chain-state-upgrade"},"On-chain state upgrade"),Object(i.b)("p",null,"On-chain state can only be updated via transactions. We propose three ways for LN to execute critical updates, ordered by most frequently expected to least frequently expected: normal multi-sig transactions, multi-sig WriteSet transactions, and genesis transactions."),Object(i.b)("h3",{id:"normal-multi-sig-transactions"},"Normal multi-sig transactions"),Object(i.b)("p",null,"Normal transactions go through VM and smart contracts, both the resulting state change and the authenticating set of signatures are transparent and visible on-chain for auditing."),Object(i.b)("p",null,"Different groups would authenticate different types of transactions. For example, there would be a group for compliance transactions and another group for validator set management."),Object(i.b)("h3",{id:"multi-sig-writeset-transactions"},"Multi-sig WriteSet transactions"),Object(i.b)("p",null,"Writeset transactions are a special type of multi-sig transactions that prescribes an arbitrary state change. Unlike normal transactions, which must follow rules such as \u201cthe reserve is the only entity that can create or destroy money\u201d, WriteSet transactions simply describe a state change rather than generate one using the blockchain logic that is encoded in Move. This type of transaction is only needed for extremely rare situations such as updating immutable stdlib libraries due to critical bugs or reversing large scale fraud."),Object(i.b)("p",null,"The use of WriteSet transactions follows the spirit of transparency \u2014 WriteSet transactions allow an arbitrary change to the state of the blockchain without altering the history of past transactions.\nEven though WriteSet transactions can describe arbitrary state change, they are authenticated with the same multi-sig mechanism as normal transactions which means both the change and multi-sig are transparent and visible on-chain."),Object(i.b)("h3",{id:"genesis-transactions"},"Genesis transactions"),Object(i.b)("p",null,"Genesis transactions can be either normal or WriteSet transactions. As the name suggests, the process is similar to how the very first genesis transaction works. The genesis transaction identifies a specific instance of a blockchain run by the Libra protocol. LN is responsible for building the genesis transaction. Users of Libra including validators use the genesis transaction to authenticate the blockchain. If a validator fails to acquire the correct genesis transaction, it will vote on an irrelevant blockchain, but not otherwise impact the system. If a user of the system acquires the incorrect genesis transaction, they will see incorrect state."),Object(i.b)("p",null,"Note after Libra starts, we may still need genesis transactions as the last resort for extremely unlikely catastrophic scenarios such as losing more than 1/3 validators."),Object(i.b)("h1",{id:"case-study"},"Case study"),Object(i.b)("p",null,"Here's a decision flow chart that summarizes the building blocks and how they will be used in specific examples."),Object(i.b)("p",null,Object(i.b)("img",Object(n.a)({parentName:"p"},{src:"../static/img/LIP-3-decision-flow.png",alt:"Decision flow"}))),Object(i.b)("h2",{id:"network-protocol-upgrade"},"Network protocol upgrade"),Object(i.b)("p",null,"Example: Changing the wire protocol in a backwards compatible way."),Object(i.b)("p",null,"Category: Spec change => Software upgrade"),Object(i.b)("h2",{id:"on-chain-config-update"},"On-chain config update"),Object(i.b)("p",null,"Example: Adding new validators to the system."),Object(i.b)("p",null,"Category: On-chain state change => Multi-sig transaction"),Object(i.b)("h2",{id:"vm-upgrade"},"VM upgrade"),Object(i.b)("p",null,"Example: New bytecode added."),Object(i.b)("p",null,"Category: Spec change + require coordination => Software upgrade + Multi-sig transaction"),Object(i.b)("h2",{id:"consensus-protocol-upgrade"},"Consensus protocol upgrade"),Object(i.b)("p",null,"Example: Switching consensus algorithm from LibraBFTv3 to LibraBFTv4."),Object(i.b)("p",null,"Category: Spec change + require coordination => Software upgrade + Multi-sig transaction"),Object(i.b)("h2",{id:"signature-scheme-change"},"Signature scheme change"),Object(i.b)("p",null,"Example: Switching consensus signature scheme from EdDSA to BLS."),Object(i.b)("p",null,"Category: Spec change + require coordination => Software upgrade + Multi-sig transaction"),Object(i.b)("h2",{id:"smart-contract-vulnerability-fixlibra-framework-upgrade"},"Smart contract vulnerability fix/Libra Framework upgrade"),Object(i.b)("p",null,"Example: DAO hack"),Object(i.b)("p",null,"Category: On-chain state change + SmartContract incapable => Multi-sig WriteSet transaction"),Object(i.b)("h2",{id:"large-fraud"},"Large fraud"),Object(i.b)("p",null,"Example: Hackers mint billions of Libra."),Object(i.b)("p",null,"Category: On-chain state change + SmartContract incapable => Multi-sig WriteSet transaction"),Object(i.b)("h2",{id:"quorum-loss"},"Quorum Loss"),Object(i.b)("p",null,"Example: F+1 validators simultaneously quit the Association and stop running their validators"),Object(i.b)("p",null,"Category: State change and consensus is dead. => Genesis transaction"))}u.isMDXComponent=!0},199:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return b}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s({},t,{},e)),a},d=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},h=Object(n.forwardRef)((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=u(a),h=n,b=d["".concat(o,".").concat(h)]||d[h]||p[h]||i;return a?r.a.createElement(b,s({ref:t},l,{components:a})):r.a.createElement(b,s({ref:t},l))}));function b(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);